# Introduction to Linear Optimization 

### Preface

本书的目的是对线性优化（即线性规划、网络流问题和离散线性优化）提供统一的、有见地的和现代的处理方法。 我们既讨论经典话题，也讨论最新技术。 我们特别关注理论，但也涵盖应用和当前案例研究。 我们的主要目标是帮助读者成为（线性）优化的资深实践者或研究人员。 更具体地说，我们希望培养制定相当复杂的优化问题的能力，提供对实际可解决的主要问题类别的评价，描述可用的解决方法，并建立对它们提供的解决方案的定性属性的理解。

我们的总体理念是洞察力最重要。 对于本书的主题，这必然需要几何视图。 另一方面，问题是由算法解决的，而这些只能用代数来描述。 因此，我们的重点是代数和几何之间的美丽相互作用。 我们使用图形和几何参数建立理解，然后将想法转化为代数公式和算法。 如果有足够的时间，我们希望读者能够毫不费力地培养从一个域到另一个域的能力。

我们的另一个目标是全面但经济。 我们已努力涵盖和突出该领域的所有主要思想。 然而，我们并没有试图成为百科全书，或者讨论与特定算法相关的每一个可能的细节。 我们的前提是，一旦对基本原理有了成熟的理解，读者就可以毫不费力地获得更多的细节。

我们的最后一个目标是让读者了解最新技术。 在我们处理内点方法、大规模优化以及扩展当前可用算法和计算机极限的案例研究的介绍中尤其如此。

任何优化方法的成功与否都取决于其处理大型重要问题的能力强弱。 从这个意义上说，关于线性优化艺术的最后一章是本书的关键部分。 我们希望它能让读者相信，在挑战性问题上取得进展既需要对问题的洞察力，也需要对基本理论有更深入的理解。

在任何处理线性规划的书中，都有一些关于**单纯形法**处理的重要选择。传统上，单纯形方法是根据完整单纯形表开发的，这往往成为中心主题。 我们发现完整的单纯形表是计算数值例子的有用工具，但除此之外，我们尽量不过分强调它的重要性。

与许多其他教科书的另一个不同之处在于，介绍性处理通常侧重于标准形式问题（理想形态的问题），这对于单纯形方法的目的来说已经足够了。 另一方面，这种方法常常让读者想知道某些属性（即，这些理性模型中所假设的参数或由此推算出的结论）是否通常为真，并且会阻碍对主题的更深入理解。 我们背离了这一传统：我们考虑线性规划问题的一般形式并在此上下文中定义关键概念（例如极值点）。  （当然，当谈到算法时，我们往往不得不专攻标准形式。）本着同样的精神，我们将线性规划的结构理解与单纯形方法的细节分开。 例如，我们包含了不依赖单纯形方法的对偶理论的推导。

最后，本书包含对几个通常不涉及的重要主题的处理。 其中包括对柱几何及其对单纯形法效率的见解的讨论、对偶性与金融资产定价之间的联系、延迟柱生成和切割平面方法的统一视图、随机规划和 Benders 分解 ，分配问题的拍卖算法，椭球算法的某些理论含义，对内点方法的彻底处理，以及关于线性优化实践的一整章。 练习中还涵盖了几个值得注意的主题，例如 Leontief 系统、严格互补性、期权定价、冯诺依曼算法、子模函数最小化以及许多整数规划问题的边界。

下面是对本书的逐章描述

第 1 章：介绍线性规划问题以及一些示例，并提供一些有关线性代数的背景资料。

第 2 章：处理多面体的基本几何性质，重点关注极值点的定义和存在，并强调几何和代数观点之间的相互作用。

第 3 章：或多或少包含与单纯形法相关的经典材料，以及对柱几何的讨论。 它从单纯形方法的高级和几何驱动推导开始。 然后介绍修改后的单纯形法，并以单纯形表结束。

第 4 章：综合处理线性规划对偶性。对偶定理首先作为单纯形方法的推论得到。 还提供了更抽象的推导，基于分离超平面定理，该定理是从第一原理发展而来的。 它以对多面体几何形状的更深入研究结束。

第 5 章：讨论敏感性分析，即解决方案和最优成本对问题数据的依赖性，包括参数规划。 它还开发了双重最优解的特征，作为适当定义的最优成本函数的次梯度。

第 6 章：介绍延迟列生成和切割平面的补充思想。 这些方法首先是在高层次上开发的，然后通过讨论下料问题、Dantzig-Wolfe 分解、随机规划和 Benders 分解来具体化。

第 7 章：全面回顾了网络流问题不同变体的主要结果和方法。 它包含所有主要或类型算法的代表：原始下降（单纯形方法）、双重上升（原始-双重方法）和近似双重上升（拍卖算法）。 重点是主要的算法思想，而不是可以导致更好的复杂性估计的改进。

第 8 章：包括对复杂性的讨论、椭球法的发展以及线性规划多项式的证明。 它还讨论了分离和优化的等价性，并提供了示例，其中椭球算法可用于为涉及指数数量约束的问题导出多项式时间结果。

第 9 章：包含所有主要类别的内点方法的概述，包括仿射缩放、潜在约简和路径跟踪（原始和原始对偶）方法。 它包括对基本几何思想和计算问题的讨论，以及收敛证明和复杂性分析。

第 10 章：介绍离散优化问题的整数规划公式。 它提供了许多示例，以及关于什么构成“强”公式的一些直觉。

第11章：涵盖整数规划算法的主要或类别，包括精确方法（分支定界、切割平面、动态规划）、近似算法和启发式方法（局部搜索和模拟退火）。 它还介绍了整数规划的对偶理论。

贯穿几章的一个重要主题是指数数约束问题的建模、复杂性和算法。 我们在第 10.3 节讨论建模，第 8.5 节讨论复杂性，第 6 章和第 8.5 章讨论算法方法，并在第 12.5 节以案例研究结束。

每章末尾都有相当数量的练习。 它们大多是为了加深对主题的理解，或探索课文中理论的扩展，而不是常规练习。 但是，还包括几个数值练习。加星标的练习应该相当困难。 可以从作者处获得适用于合格教师的解决方案手册。

我们特别努力使文本尽可能模块化，允许读者在不失去连续性的情况下省略某些主题。 例如，本书其余部分很少使用第 5 章和第 6 章中的大部分材料。 此外，在第 7 章（关于网络流问题）中，已经完成了问题表述（第 7.1-7.2 节）的读者可以立即转到该章的任何后面的部分。 另外，第 9 章的内点算法在后面也没有用到，除了第 12 章中的一些应用。 即使在核心章节（第 1-4 章）中，也有很多章节可以在初读时跳过 . 某些部分已标有星号，表明它们包含一些通常不包含在介绍性课程中的更高级的材料。

这本书是在我们轮流在 M.I.T 教授一年级研究生课程时编写的，适用于工程和运筹学专业的学生。唯一的先决条件是线性代数的工作知识。 事实上，它只需要线性代数的一个小子集（例如，子空间的概念、线性独立性和矩阵的秩）。然而，这些基本工具有时会以微妙的方式使用，读者在数学上的一些成熟可以导致对主题的更好理解。

这本书可用于教授几种不同类型的课程。 下面的前两个建议是我们在 M.I.T 尝试过的一个学期的变体，但也有其他有意义的选择，具体取决于学生的背景和课程目标。

(a) 涵盖第 1-7 章的大部分内容，如果时间允许，涵盖第 9-12 章的少量主题

(b) 替代方案可能与上述相同，除了内点算法（第 9 章）被完全覆盖，取代了网络流问题（第 7 章）。

(c) 可以通过集中在大多数章节中较简单的材料来构建广泛的概述课程。 此类课程的核心可能包括第 1 章第 2 节。2.1-2.4、3.1-3.5、4.1-4.3、5.1、7.1-7.3、9.1、10.1，以及章节中的一些较简单的材料 11 ，以及第 12 章中的应用程序。

(d) 最后，本书也适用于整数规划的半课程，基于第 1 章和第 8 章以及第 10-12 章的部分内容。

有大量关于线性优化的文献，我们不尝试提供全面的参考书目。 在很大程度上，我们引用的来源要么是具有历史意义的原始参考资料，要么是可以找到附加信息的近期文本。 然而，对于那些涉及当前研究的主题，我们还提供了指向最近的期刊文章的指针。

我们要向一些人表示感谢。 我们感谢我们的同事 Dimitri Bertsekas 和 Rob Freund，他们对本书中的主题进行了多次讨论，并阅读了部分手稿。 我们的一些学生、同事和朋友通过阅读部分手稿、提供批判性评论和练习练习做出了贡献：Jim Christodouleas、Thalia Chryssikou、Austin Frakt、David Gamarnik、Leon Hsu、Spyros Kontogiorgis、Peter Marbach、Gina  Mourtzinou、Yannis Paschalidis、Georgia Perakis、Lakis Polymenakos、Jay Sethuraman、Sarah Stock、Paul Tseng 和 Ben Van Roy。但最重要的是，我们感谢我们的家人在这个漫长的项目过程中的耐心、爱和支持。

## Chapter 1 Introduction

在本章中，我们介绍线性规划，即在线性等式和不等式约束下最小化线性成本函数的问题。我们考虑一些等价形式，然后提供一些示例来说明线性规划在各种上下文中的适用性。 我们还解决了一些简单的例子，并对问题的性质获得了一些基本的几何直觉。 本章最后回顾了线性代数和用于描述算法的计算要求（操作数）的约定。

### 1.1 Variants of the linear programming problem

在本节中，我们提出线性规划问题，讨论它采用的一些特殊形式，并建立一些我们将使用的标准符号。 我们不是抽象地开始，而是首先陈述一个具体的例子，它旨在促进对后面的正式定义的理解。 我们给出的例子没有任何解释。 稍后，在第 1.2 节中，我们将有充足的机会开发实际环境中出现的示例。

Example 1 . 1 The following is a linear programming problem

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720135704696.png" alt="image-20210720135704696" style="zoom: 50%;" />

这里 $x_1、x_2、x_3$ 和 $x_4$ 是变量，其值将被选择以最小化线性成本函数 $2x_1 - x_2 + 4x_3$，该函数受一组线性等式和不等式约束。 其中一些约束，例如 $x_1\ge0$ 和 $x_3 \le 0$ ，相当于对某些变量的符号的简单限制。 其余约束的形式为 $a'x \le b$、$a'x = b$ 或 $a'x \geq b$ ，其中 $a = (a_1 , a_2 , a_3 , a_4 )$ 是给定的系数向量（注1） , $x = (x_l  , x_2 , x_3 , x_4)$ 是决策变量的向量，$a'x$ 是它们的内积 $\Sigma_{i=1}^4a_ix_i$ ，而 $b$ 是给定的标量 。 例如，在第一个约束中，我们有 $a = ( 1 , 1 , 0 , 1 )$ 和 $b = 2$。

注1：正如第 1.5 节中进一步讨论的，所有向量都被假定为列向量，并在矩阵向量乘积中被如此对待。 行向量表示为（列）向量的转置。 然而，每当我们在文本中引用向量 x 时，我们都会使用更经济的符号 $x = (x_1, ... , x_n )$，即使 $x$ 是一个列向量。不熟悉我们的符号的读者可能希望在继续之前查阅第 1.5 节。

现在可以如此概括，在一般线性规划问题中，我们给定了一个成本向量 $c = (c_1, . . , c_n)$ 并且我们寻求可以最小化线性成本函数 $c'x = \Sigma_{i=1}^nc_ix_i $ 的 $n$ 维向量 $x=(x_1,...,x_n)$，并且该向量服从一组线性等式和不等式约束。 特别地，让 $M_I$, $M_2$, $M_3$ 是一些有限索引集（设 $\mathtt{A}$ 是一个非空集合，对于每个 $α ∈\mathtt{A}$，设 $A_α$ 是一个集合。 那么$\{A_α;  α ∈ \mathtt{A}\}$ 称为集合族，$\mathtt{A}$ 是该族的索引集**(index set)**），并假设对于这些集合中的任何一个中的每个 $i$，我们都被赋予了一个 $n$ 维向量 $a_i$ 和一个标量 $b_i$ ，它们将用于形成第 $i$ 个 约束。 假设 $N_1$ 和 $N_2$ 是 $\{1,  .  .  , n\}$ 的子集，对于左侧集合中的编号而言，他们给定了决策变量 $x_j$ 的正负性。 然后我们考虑问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720144937371.png" alt="image-20210720144937371" style="zoom: 50%;" />

变量 $x_1 , .  .  .  , x_n$ 称为决策变量，满足所有约束条件的向量 $x$ 称为可行解或可行向量，所有可行解的集合称为可行集或可行域。如果 $j$ 既不在 $N_1$ 也不在 $N_2$ 中，则 $X_j$ 的符号没有限制，在这种情况下，我们说 $X_j$ 是一个自由或不受限制的变量。 函数 $c'x$ 称为目标函数或成本函数。 最小化目标函数的可行解 $x^*$（即 $c'x^* \le c'x$，​对于所有可行的 $x$）被称为最优可行解，或者简称为最优解。 然后将 $c'x^*$ 的值称为最优成本。 另一方面，如果对于每一个实数 $K$ 我们都可以找到一个可行解 $x$ 使其成本小于 $K$，我们说最优成本是 $-\infin$ 或成本是无下界的。（有时，我们会滥用术语，说问题是无界的。）我们最后注意到，没有必要单独研究最大化问题，因为最大化 $c'x$ 等效于最小化线性成本函数 $-c'x$。

一个等式约束 $a'_ix = b_i$ 等价于两个约束 $a_i'x \geq b_i$ 和 $a_x'\le b_i$ 此外，任何形式为 $a_i'x \le b_i;$ 的约束条件，都可以改写为 $(-a_i )'x\geq -b_i$。 最后，$x_j \geq 0$ 或 $x_j \le 0$ 形式的约束都是 $a_i'x \geq b_i$ 的特殊情况，其中 $a_i'$ 是单位向量，$b_i = 0$。假设总共有 $m$ 个这样的约束，由 $i = 1 , ... , m$ 索引，让 $b = (b_1 , ... , b_m)$，并让 A 是 $m\times n$ 矩阵，其行是行向量 $a_1'   , ... , a_m'$ , 即 , 

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150115067.png" alt="image-20210720150115067" style="zoom: 50%;" />

那么，约束 $a_i' x \geq b_i , i = 1 , ... , m$, 可以简洁地表示为 $Ax \geq b$ 的形式，线性规划问题可以写成

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150311713.png" alt="image-20210720150311713" style="zoom: 50%;" />

诸如 $Ax \geq b$ 之类的不等式将始终按分量进行解释； 也就是说，对于每个 $i$ ，向量 $Ax$ 的第 $i$ 个分量，即 $a_i'x$，大于或等于向量 $b$ 的第 $i$ 个分量 $b_i$。

Example 1.2 The linear programming problem in Example 1.1 can be rewritten as

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150445183.png" alt="image-20210720150445183" style="zoom: 50%;" />

这与问题 (1.2) 的形式相同，其中 c = (2, - 1 , 4, 0) ，

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150628980.png" alt="image-20210720150628980" style="zoom:50%;" />

##### Standard form problems

一般的线性规划问题包含有下面的形式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150725660.png" alt="image-20210720150725660" style="zoom:50%;" />

该形式被称为其标准形式。 我们以标准形式提供问题的解释。 假设 $x$ 的维度为 $n$ 并s设 $A_1 ,   .  .  , A_n$ 是 $A$ 的列。 那么约束 $Ax = b$ 可以写成

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150851634.png" alt="image-20210720150851634" style="zoom:50%;" />

直观地说，有 $n$ 个可用的资源向量 $A_1 ,.  .  . , A_n$ , 和一个目标向量 $b$. 我们希望通过使用每个资源向量 $A_i$ 的非负倍数 $x_i$ 来“合成”目标向量 $b$，同时最小化成本 $\Sigma_{i=1}^nc_ix_i$ ，其中 $c_i$ 是第 $i$ 个资源的单位成本。 下面是一个更具体的例子。

Example 1.3 （饮食问题）假设有 $n$ 种不同的食物和 $m$ 种不同的营养成分，下表中给出了食物的种类和其对应的营养成分种类及其含量

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720151411312.png" alt="image-20210720151411312" style="zoom:67%;" />

设 $A$ 为元素为 $a_{ij}$ 的 $m \times n$ 矩阵。 请注意，该矩阵的第 $j$ 列 $A_j$ 表示第 $j$ 种食物的营养成分。 让 $b$ 是一个具有理想饮食要求的向量，或者等价地，一个“理想食物”的营养成分的规范。 然后我们将标准形式问题解释为混合可用食物的非负数量 $x_i$ 的问题，并以最小成本合成理想食物。 在这个问题的一个变体中，向量 $b$ 指定了充足饮食的最低要求； 在这种情况下，约束 $Ax = b$ 被 $Ax \geq b$ 替换，并且问题不是标准形式。

##### Reduction to standard form

如前所述，任何线性规划问题，包括标准形式问题 (1.3) ，都是一般形式 (1.1) 的特例。 我们现在认为反过来也是正确的，并且一般线性规划问题可以转换为标准形式的等价问题。

在这里，当我们说这两个问题是等价的时，我们的意思是，给定一个问题的可行解，我们可以以相同的代价构造另一个问题的可行解（即，构造这两个问题的可行解的代价相同）。 特别地，这两个问题具有相同的最优成本，并且给定一个问题的最优解，我们可以构造另一个问题的最优解。 我们想到的问题转化包括两个步骤：

(a) 消除自由变量：在一般形式的问题中给定一个不受限制的变量 $x_j$，我们可以用 $x_j^+ - x_j^-$ 替换它，其中 $x_j^+$ 和 $x_j^-$ 是我们施加符号约束 $x_j^+\geq 0$ 和 $x_j^-\geq 0$ 的新变量 . 基本思想是任何实数都可以写成两个非负数的差。

(b) 消除不等式约束：给定形式为不等式约束

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152107103.png" alt="image-20210720152107103" style="zoom:50%;" />

我们引入了一个新的变量 $s_i$ 以形成标准形式的约束

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152157249.png" alt="image-20210720152157249" style="zoom:67%;" />

这种变量 $s_i$ 被称为松弛变量。 类似地，不等式约束 $\Sigma_{j=1}^na_{ij}x_j\geq b_i$ 可以通过引入一个剩余变量（surplus variable) $s_i$ 以变为标准形式的约束 $\Sigma_{j=1}^na_{ij}x_j-s_i= b_i$

我们得出结论，一般问题都可以转变为标准形式，因此，我们只需要开发能够解决标准形式问题的方法

Example 1.4 The problem

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152824141.png" alt="image-20210720152824141" style="zoom:50%;" />

等价于标准形式问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152915960.png" alt="image-20210720152915960" style="zoom: 50%;" />

例如，给定原问题的可行解 $(x_1  , x_2 )$ $= (6, -2)$，我们得到可行解 $(x_1 , x_2^+ , x_2^-, x_3 ) = (6, 0, 2  , 1 )$ 这两者的成本相同。 反之，给定标准形式问题的可行解 $(x_1 , x_2^+, x_2^-, x_3) = (8, 1 , 6 , 0)，$我们得到可行解 $(x_ 1 , x_2 ) = (8, -  5）$ 同样会以相同的成本解决原来的问题。

在后续中，我们会经常使用一般形式 $Ax \geq b$ 来发展线性规划理论。 然而，当谈到算法时，尤其是单纯形法和内点法时，我们将重点关注标准形式 $Ax = b, x\geq 0$，它在计算上更方便。

### 1.2 Examples of linear programming problems

在本节中，我们将讨论一些线性规划问题的示例。 我们的目的之一是指出可以应用线性规划的广泛情况。 另一个目的是熟悉构建松散定义优化问题的数学公式的艺术

##### A production problem

一家公司使用 $m$ 种不同的原材料生产 $n$ 种不同的商品。 记 $b_i , i = 1, ...  , m$ 是第 $i$ 种原料的可用量。 第 $j$ 个商品 $j = 1, ... , n$ 需要 $a_{ij}$ 单位的第 $i$ 种材料并导致每生产单位的收入为 $c_j$。 公司面临的问题是决定生产多少每种商品以使其总收入最大化。

在这个例子中，决策变量的选择很简单。 设 $x_j , j = 1, .  .  .  , n$ 是第 j 个商品的数量。 那么，企业面临的问题可以表述为：

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721000159600.png" alt="image-20210721000159600" style="zoom: 50%;" />

##### Production planning by a computer manufacturer

我们在此考虑的示例是 Digital Equipment Corporation (DEC) 在 1988 年第四季度面临的一个问题。它说明了现实世界应用程序的复杂性和不确定性，以及数学建模对制定重要战略决策的有用性。

1988 年第二季度，DEC 推出了一个新的（单 CPU）计算机系统和工作站系列：GP-1、GP-2 和 GP-3，它们分别具有不同的内存、磁盘存储大小和扩展能力，作为工作站的 WS-1 和 WS-2 这两款产品也一样。 在表 1. 1 中，我们列出了型号、标价、每个系统的平均磁盘使用量和内存使用量。 例如，GP-l 使用四块 256K 内存板，每 10 个产品中有 3 个会包含磁盘驱动器（这基于客户的需求，原始产品并不包含此项）。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721000409570.png" alt="image-20210721000409570" style="zoom:50%;" />

这个新产品系列的出货将从第三季度开始，并在第四季度缓慢增长。 预计下一季度将面临以下困难：

(a) 由于调试问题，内部 CPU 供应商最多可以提供 7,000 个单元。

(b) 磁盘驱动器的供应不确定，制造商估计在 3,000 至 7,000 台之间。

(c) 256K 内存板的供应也被限制在 8,000 至 16,000 块的范围内。

在需求方面，市场部确定1989一季度的最大需求为GP-1系统1800台、GP-3系统300台、GP全系3800台以及3200台 WS 系列的系统。 这些预测包括 500 份 GP-2 订单、500 份 WS-1 订单和 400 份 WS-2 订单，这些订单已经收到并必须在下个季度完成。

在前几个季度，为了解决磁盘驱动器短缺的问题，DEC 生产了没有磁盘驱动器的 GP-1、GP-3 和 WS-2（尽管 GP-1 系统的 10 个客户中有 3 个想要磁盘驱动器）, GP-2, WS-1 带一个磁盘驱动器。 我们将这种配置系统的方式称为**受约束的生产模式**。

此外，DEC 在GP-1 系统中使用可以通过在每个系统中使用两块备用的 256K 数据版以解决数据版短缺的问题。  DEC 可以在下个季度提供 4,000 个替代板。

制造人员很清楚问题已经变得复杂，因为收入、盈利能力和客户满意度都处于危险之中。需要做出以下决定：

(a) 1989年第一季度的生产计划。

(b) 关于磁盘驱动器的使用，DEC 应该继续在受限模式下生产产品，还是应该计划满足客户的喜好？

(c) 关于内存板，DEC 是否应该为其 GP-1 系统使用替代内存板？

(d) 必须做出的最终决定与磁盘驱动器短缺和 256K 内存板短缺之间的权衡有关。 制造人员想集中精力减少磁盘短缺的影响或减少256K内存板短缺的影响。 因此，他们想知道哪种替代方案会对收入产生更大的影响。

为了模拟 DEC 面临的问题，我们引入了变量 $x_1、x_2、x_3、x_4、x_5$，它们代表 GP-1、GP2、GP-3、WS-1 和 WS-2 的数量（以千计），分别将在下个季度生产。 严格来说，由于 $1000x_i$ 代表单位1，所以它（指的是 $1000x_i$ ） 必须是一个整数。 这可以通过截断每个 $x_i$ 第三个小数点后来实现； 考虑到需求的大小以及变量 $x_i$ 的大小，这具有可以忽略不计的影响并且可以忽略对 $1000x_i$ 的完整性约束。

DEC 必须做出两个截然不同的决定：是否使用有关磁盘驱动器使用的受限生产模式，以及是否为 GP-1 系统使用替代内存板。 因此，有四种不同的可能选择组合。

我们首先为不使用替代内存板并选择磁盘驱动器生产受限模式的情况开发模型。 该问题可以表述如下： 

![image-20210721001942369](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721001942369.png)

请注意，目标函数的值在数百万美元。 在某些方面，这是一个悲观的表述，因为 256K 内存和磁盘驱动器可用性分别设置为 8 和 3，这是估计范围内的最低值。 确定此问题的解决方案实际上很有趣，因为 256K 内存可用性范围为 8 到 16，而磁盘驱动器可用性范围为 3 到 7，因为这提供了有关最佳解决方案对可用性的敏感性的宝贵信息。 在另一个方面，该公式是乐观的，例如，它假设 GP-1 系统的收入对于任何 $x_1\le1.8$; 都是 $60k$ ，即使不能保证每一个客户对 1,800 台 GP-1 系统的个性化需求。

为了适应 DEC 的其他三个选择，必须修改一些问题约束，如下所示。 如果我们对磁盘驱动器使用无约束生产模式，则约束 $x_2+x_4 \le 3$ 被替换为

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721002356433.png" alt="image-20210721002356433" style="zoom: 50%;" />

此外，如果我们希望在 GP-1 系统中使用替代内存板，我们将替换约束 $4x_1+2x_2+2x_3+2x_4+x_6\le8$ 为新的两个约束条件

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721002528611.png" alt="image-20210721002528611" style="zoom: 50%;" />四种选择组合导致四种不同的线性规划问题，每一种都需要针对不同的参数值求解，因为如前所述，某些约束的右侧只知道位于特定范围内。当某些参数允许在某个范围内变化时，求解线性规划问题的方法将在第 5 章中进行研究，并在此案例研究中重新讨论

##### Multiperiod planning of electric power capacity

一个州想要规划其未来 $T$ 年的电力容量。 该州对 $t = 1 , .  .  ，T$ 年的电力需求预测为 $d_t$ 兆瓦，假定准确。而现有的电力容量（燃油电厂）将不会在未来的 $t$ 年内损毁，并且假设其每年的发电容量不会发生变化，该值记为 $e_t$ 。 扩大电力容量有两种选择：新建燃煤电厂或核电厂。 燃煤电厂在 $t$ 年初投入运营的每兆瓦燃煤容量的资本成本为 $c_t$。核电站的相应资本成本为 $n_t$ 。 出于各种政治和安全原因，已决定核电容量不得超过总容量的 20%。 燃煤电厂的使用寿命为 20 年，而核电厂的使用寿命为 15 年。 需要一个成本最低的容量扩展计划。

将此问题表述为线性规划问题的第一步是定义决策变量。 设 $x_t$ 和 $y_t$ 是 t 年初上线的煤炭（核能）装机量。 设 $w_t$ 和 $z_t$ 是 $t$ 年可用的煤炭（核能）装机总量。 因此，容量扩展计划的成本是，

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003237438.png" alt="image-20210721003237438" style="zoom: 50%;" />

因为燃煤电厂可以持续运营 20 年，我们有

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003441615.png" alt="image-20210721003441615" style="zoom:67%;" />

同样，对于核电站

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003545600.png" alt="image-20210721003545600" style="zoom:50%;" />

由于可用容量必须满足预测的需求，我们要求

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003642005.png" alt="image-20210721003642005" style="zoom:50%;" />

最后，由于核电不应超过总容量的 20%，我们有

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003713836.png" alt="image-20210721003713836" style="zoom:50%;" />

可以写成

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003818971.png" alt="image-20210721003818971" style="zoom:50%;" />

总结一下，扩容问题如下

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003843697.png" alt="image-20210721003843697" style="zoom:50%;" />

我们注意到这种表述并不完全现实，因为它忽略了可能有利于大型工厂的某些规模经济。 但是，它可以提供对真实成本的大致估计

##### A scheduling problem

在前面的例子中，决策变量的选择相当简单。 我们现在讨论这个选择不太明显的例子。一家医院希望为其护士制定每周夜班（中午 12 点至早上 8 点）的时间表。 第 $j$ 天夜班护士的需求是一个整数 $d_j$ , $j = 1 , .  .  .  , 7$. 每个护士连续工作 5 天夜班。 问题是找到医院需要雇用的最少数量的护士。

可以尝试使用等于在第 $j$ 天工作的护士数量的决策变量 $y_j$。 然而，根据这个定义，我们无法捕捉到每个护士连续工作 5 天的约束。 出于这个原因，我们选择不同的决策变量，即定义变量 $x_j$ ，其数值大小为在 $j$ 天开始工作的护士数量。（例如，一周从第 5 天开始的护士将在第 $5、6、7、1、2$ 天工作。）然后我们有以下问题表述：

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721004210420.png" alt="image-20210721004210420" style="zoom:50%;" />

这将是一个线性规划问题，而且包含每个 $x_j$ 必须是整数的约束，因此我们实际上有一个线性整数规划问题。 处理这个问题的一种方法是忽略（“放松”）完整约束并获得原始问题的所谓线性规划松弛。 由于线性规划问题的约束较少，因此选项较多，因此最优成本将小于或等于原始问题的最优成本。 在这里，我们可以先忽略得到的结果必须是整数的约束，因此如果线性规划松弛的最优解恰好是整数，那么它也是原问题的最优解。 如果它不是整数，我们可以将每个 $x_j$ 向上舍入，从而获得原始问题的可行但不一定最优的解决方案。 事实证明，对于这个特定问题，无需太多努力即可找到最佳解决方案。然而，这是例外而不是规则：找到一般整数规划问题的最佳解决方案通常很困难； 一些方法将在第 11 章中讨论。

##### Choosing paths in a communication network

考虑一个由 $n$ 个节点组成的通信网络，节点之间通过通信链路连接。 从节点 $i$ 到节点 $j$ 单向传输的链路由有序对 $(i , j )$ 描述。 设 $\mathcal{A}$ 为所有链接的集合。 我们假设每条链路 $(i, j) \in \mathcal{A}$ 每秒最多可承载 $u_{ij}$ 比特。 沿该链路传输的每比特都相当于传输了 $c_{ij}$ 个正电荷。 每个节点 $k$ 以每秒 $b^{k\mathscr{l}}$ 比特的速率生成数据，这些数据必须通过直接链接 $(k,l )$ 或通过一系列的链接传输到节点 $l$ 。 问题是选择所有数据到达其预定目的地的路径，同时最小化总成本。我们允许具有相同来源和相同目的地的数据被拆分并沿着不同的路径传输。

为了将此问题表述为线性规划问题，我们引入了变量 $x_{ij}^{kl}$，表示经过链接 $(i, j)$ 的，起点为 $k$ 和终点 $l$ 的数据，并且记

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721005821978.png" alt="image-20210721005821978" style="zoom:50%;" />

因此，$b_i^{kl}$ 是节点 $i$ 处来自网络外部的源为 $k$ 和目的地为 $l$ 的数据的净流入。 然后我们有以下公式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010148354.png" alt="image-20210721010148354" style="zoom:50%;" />

第一个约束是节点 $i$ 处的流守恒约束，用于具有源 $k$ 和目的地 $l$ 的数据。表达式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010314682.png" alt="image-20210721010314682" style="zoom:50%;" />

分别表示沿某条链路离开节点 $i$ 的具有起点和终点 $k$ 和 $l$ 的数据量。 表达式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010457968.png" alt="image-20210721010457968" style="zoom:50%;" />

表示通过某个链接进入节点 $i$ 的具有相同来源和目的地的数据量。 最后，$b_i^{kl}$ 是从网络外部进入节点 $i$ 的此类数据的净量。 第二个约束表示通过链路 $(i, j)$ 的总流量不能超过链路容量的要求。

这个问题被称为多商品流问题，对应于每个起点-终点对的流量被视为不同的商品。 当我们考虑一家运输公司希望通过网络将多种商品从原产地运输到目的地时，会出现数学上类似的问题。 这个问题有一个版本，称为最小成本网络流问题，我们不区分不同的商品。 相反，我们在每个节点 $i$ 处获得外部供应或需求量 $b_i$，目标是以最小成本将材料从供应节点运输到需求节点。 网络流问题是第 7 章的主题，它包含一些重要问题作为特殊情况，例如最短路径问题、最大流问题和分配问题。

##### Pattern classification

我们给出了 $m$ 个对象的例子，对于每个对象，比如说第 $i$ 个对象，用一个 $n$ 维向量 $a_i$; 来描述它的特征。 对象属于两个类之一，对于每个示例，我们都被告知它所属的类。

更具体地说，假设每个对象都是一个苹果或一个橙子的图像（这是我们的两个类）。 在这种情况下，我们可以使用一个三维特征向量 $a_i$ 来概括第 $i$ 个图像的内容。  $a_i$ 的三个组成部分（特征）可以是物体的椭圆度、茎的长度和颜色，以某种尺度衡量。 我们有兴趣设计一个分类器，给定一个新对象（除了最初可用的示例之外），它将确定它是一个苹果的图像还是一个橙子的图像。

线性分类器是根据 $n$ 维向量 $x$ 和标量 $x_{n+1}$ 定义的，其操作如下。 给定一个具有特征向量 $a$ 的新对象，分类器将其声明为第一类对象，如果

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010937777.png" alt="image-20210721010937777" style="zoom:50%;" />

和第二类如果

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721011000413.png" alt="image-20210721011000413" style="zoom:50%;" />

换句话说，线性分类器根据不同特征的线性组合做出决策。 我们的目标是使用可用的例子来设计一个“好的”线性分类器。

有很多方法可以解决这个问题，但一个合理的起点可能是要求分类器必须为每个可用示例给出正确的答案。 设 $S$ 是第一类的例子集。 然后我们正在寻找一些满足约束的 $x$ 和 $x_{n+1}$

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721011121474.png" alt="image-20210721011121474" style="zoom:50%;" />

请注意，第二组约束涉及严格的不等式，并不完全是线性规划中出现的形式。 这个问题可以通过以下方式解决，如果观察到 $x$ 和 $x_{n+1}$ 的某些选择满足所有上述约束，则存在一些其他选择（通过将 $x$ 和 $x_{n+1}$ 乘以适当大的正标量获得）满足

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721011537262.png" alt="image-20210721011537262" style="zoom:50%;" />

我们得出结论，寻找与所有可用示例一致的线性分类器是寻找线性规划问题的可行解的问题

### 1.3 Piecewise linear convex objective functions

上一节中的所有示例都涉及线性目标函数。 然而，有一类重要的优化问题具有非线性目标函数，可以转化为线性规划问题； 接下来将处理这些问题。

我们首先需要一些定义： 

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721012651386.png" alt="image-20210721012651386" style="zoom:50%;" />

请注意，如果 $x$ 和 $y$ 是 $\mathfrak{R}^n$ 中的向量，并且 $\lambda$ 范围在 $[0 , 1]$  中，那么形式为 $\lambda x + (1 - \lambda)y$ 的点属于连接 $x$ 和 $y$ 的线段。 凸函数的定义是指 $f$ 的值，因为它的参数跟踪这个段。 如果 $f$ 是线性的，则定义的 (a) 部分中的不等式将成立。 因此，不等式意味着当我们将注意力限制在这样的段上时，函数的图形将不高于相应的线性函数的图形； 见图1.1（a）

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721093556396.png" alt="image-20210721093556396" style="zoom:50%;" />

很容易看出，函数 $f$ 是凸函数当且仅当 $-f$ 是凸函数。 请注意，形式为 $f(x) = a_o + \Sigma_{i=1}^n a_ix_i$ 的函数（其中 $a_0, .  .  .  , a_n$ 是标量），称为仿射函数，既是凸函数又是凹函数。  （事实证明，仿射函数是唯一既是凸函数又是凹函数的函数。）凸函数（以及凹函数）在优化中起着核心作用。

我们说，如果对于 $x$ 附近的 $y$ 都存在 $f(x) \le  f(y)$ ，则称向量 $x$ 是 $f$ 的局部最小值；同理，如果对于定义域内的任意 $y$ ，都有 $f(x)\le f(y)$ 则称向量 $x$ 是 $f(x)$ 的全局最小值。一个凸函数的局部极小值必然是其全局最小值（见图1.1），这个性质对设计高效的优化算法有很大帮助。

记 $c_1 , .  .  .  , c_m$ 是 $\mathfrak{R}_n$ 中的向量，令 $d_1 , .  .  .  , d_m$ 为标量，并考虑函数 $f : \mathfrak{R}_n \mapsto \mathfrak{R}$ ，定义为

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721094642374.png" alt="image-20210721094642374" style="zoom:50%;" />

我们说这样的函数必然是凹函数，因为

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721100237303.png" alt="image-20210721100237303" style="zoom:50%;" />

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721100327044.png" alt="image-20210721100327044" style="zoom:50%;" />

函数形式为 $max_{i=1,...,m}(c'_ix+d_i)$ 的函数称为分段线性凸函数。一个简单的例子是由$f（x）=|x |=max\{x，-x\} $定义的绝对值函数。如图1.2（b）所示，分段线性凸函数可以用来逼近一般凸函数。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721101200104.png" alt="image-20210721101200104" style="zoom:50%;" />

现在我们考虑线性规划的一个推广，其中目标函数是分段线性和凸的而不是线性的：

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721101219432.png" alt="image-20210721101219432" style="zoom:50%;" />

注意，$max_{i=1,...,m}(c'_ix+d_i)$ 相当于求一个最小的数 $z$ ，该 $z$ 满足 $z\geq c_i'x+d_i$ 。因此，所考虑的优化问题等价于线性规划问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721102812256.png" alt="image-20210721102812256" style="zoom:50%;" />

其中决策变量是 $z$ 和 $x$

总之，线性规划可以用来解决分段线性凸代价函数的问题，而后一类函数可以作为更一般的凸代价函数的近似。另一方面，这种分段线性逼近并不总是一个好主意，因为它会将光滑函数转化为非光滑函数（分段线性函数具有不连续的导数）。

最后我们注意到，如果给定一个形式为 $f(x)\le h$ 的约束，其中 $f$ 是分段线性凸函数$f(x)=max_{i=1，...,m}（f_i'x+g_i）$，这样的约束可以重写为

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721103103631.png" alt="image-20210721103103631" style="zoom:50%;" />

线性规划同样适用。

##### Problems involving absolute values

考虑一个具有以下形式的问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721103151058.png" alt="image-20210721103151058" style="zoom:50%;" />

其中 $x=(x_1,...,x_n)$，其中成本系数为 $c_i$（假设为非负）。该成本函数不难证明是分段线性且是凸函数（练习1.2）。然而，以 $max_j(c_j'x+d_j)$ 的形式表示该代价函数有点复杂，我们可以有更好的方法来表示。我们观察到 $|x_i|$ 实际上是满足条件 $x_i\le z_i$ 和  $-x_i\le z_i$ 的 $z_i$ 的最小值，因此我们得到了线性规划公式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721103752529.png" alt="image-20210721103752529" style="zoom:50%;" />

处理绝对值的另一种方法是引入新变量 $x_i^+ , x_i^-$ ，约束为非负，并让 $x_i = x_i^+ - x_i^-$ 。（我们的目的是让 $x_i = x_i^+$ 或 $x_i = -x_i^-$ ，这取决于 $x_i$ 是正还是负。）然后我们用 $x_i^+ + x_i^+$ 替换每个出现的 $| x_i |$ 并获得替代公式 

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721104128056.png" alt="image-20210721104128056" style="zoom:50%;" />

$x_i = x_i^+ - x_i^- , x_i^+\geq0,x_i^- \geq 0$ 的关系不足以保证 $|x_i | =x_i^+ + x_i^+ $ ，这种重新表述的有效性可能并不完全明显。 为简单起见，让我们假设对于所有 $i$ ，有 $c_i > 0$。 在重新制定问题的最佳解决方案中，对于每个 $i$，我们必须有 $x_i^+ = 0$ 或 $x_i^- = 0$，否则我们可以将 $x_i^+$ 和 $x_i^-$ 减少相同的数量并保持可行性，同时降低成本。 在保证 $x_i^+ = 0$ 或 $x_i^- = 0$ 之后，现在遵循所需的关系 $|x_i |  =x_i^+ + x_i^+$。

此处提出的两个重新表述的形式正确性，以及在更一般的条件中，是练习 1.5 的主题。 我们还注意到，成本系数 $c_i$ 的非负假设至关重要，因为若非如此，成本标准就会是非凸的。

Example 1.5 Consider the problem

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721105058559.png" alt="image-20210721105058559" style="zoom:50%;" />

我们的第一种方法可以得到

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721105202102.png" alt="image-20210721105202102" style="zoom: 50%;" />

而第二种则得到

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721105221660.png" alt="image-20210721105221660" style="zoom:50%;" />

我们现在继续一些涉及分段线性凸目标函数的应用

##### Data fitting

给定 $m$ 个数据点，形式为 $(a_i, b_i ), i = 1, .  .  .  , m$，其中 $a_i \in \mathfrak{R}^n$ , $b_i \in \mathfrak{R}^n$，我们希望建立一个模型，根据向量 $a$ 的一些信息预测变量 $b$ 的值。 在这种情况下，人们经常使用 $b = a'x$ 形式的线性模型，其中 $x$ 是要确定的参数向量。

给定一个特定的参数向量 $x$，其残差或称“预测误差”，在第 $i$ 个数据点被定义为 $| b_i-a_i'x|$ 。 给定替代模型之间的选择，人们应该选择一种尽可能“解释”可用数据的模型，即 ，一个小残差的模型。

一种方法是最小化最大残差。 这是最小化的问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721105839823.png" alt="image-20210721105839823" style="zoom:50%;" />

 $x$ 不受任何约束。 请注意，我们在这里处理的是分段线性凸成本函数。 下面是一个等效的线性规划公式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721111934299.png" alt="image-20210721111934299" style="zoom:50%;" />

在替代公式中，我们可以使用改换后的成本函数

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721112805906.png" alt="image-20210721112805906" style="zoom:50%;" />

由于$|  b_i-a_i'x|$ 是满足 $ b_i-a_i'x\le z_i$ 和 $-b_i+a_i'x \le z_i$ 的最小数 $z_i$, 我们得到公式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721113053256.png" alt="image-20210721113053256" style="zoom:50%;" />

在实践中，不妨使用二次成本准则 $\Sigma_{i=1}^m(b_i-a_i'x)^2$ ，以获得“最小二乘拟合”。 这是一个比线性规划更容易的问题； 它可以使用微积分方法解决，但它的讨论超出了本书的范围。

##### Optimal control of linear systems

考虑一个动态系统，它根据以下形式的模型演化

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721114313691.png" alt="image-20210721114313691" style="zoom:50%;" />

这里 $x(t)$ 是系统在时间 $t$ 的状态，$y(t)$ 是系统输出，假定是一个标量，而 $u(t)$ 是一个控制向量，我们可以自由选择受以下形式的线性约束 $Du(t) \le d$ [这些可能包括饱和约束，即 $u(t)$ 的每个分量的大小的硬边界]。 举一些可能的应用，这可以是飞机模型、发动机模型、电路模型、机械系统模型、制造系统模型，甚至是经济增长模型。 我们还给出了初始状态 $x(0)$ 。 在一个可能的问题中，我们要选择控制变量 $u(0),...,u(T-1)$ 的值,将状态 $x(T)$ 驱动到目标状态，为简单起见假设为零。 除了将状态归零外，通常还希望在所有中间时间都保持较小的输出幅度，我们希望最小化

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721114858079.png" alt="image-20210721114858079" style="zoom:50%;" />

然后我们得到以下线性规划问题：

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721114914062.png" alt="image-20210721114914062" style="zoom:50%;" />

状态向量 $x(t)$ 上附加的线性约束，或状态和控制的更一般的分段线性凸成本函数，也可以合并。

##### Rocket control

考虑沿直线路径行进的火箭。 设 $x_t$ 、$v_t$ 和 $a_t$ 分别是火箭在时间 $t$ 的位置、速度和加速度。 通过对时间进行离散化，并取时间增量为 1，我们得到一个近似的离散时间模型，形式为

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721115933921.png" alt="image-20210721115933921" style="zoom:50%;" />

我们假设加速度在我们的控制之下，因为它是由火箭推力决定的。 在一个粗略的模型中，可以假设加速度的大小与时间 $t$ 的燃料消耗率成正比。

假设火箭最初在原点静止，即 $x_0 = 0$ 且 $v_0 = 0$。 我们希望火箭在 $T$ 个时间单位后在距原点单位距离处和“软着陆”，即 $x_T = 1$ 和 $v_T = 0$。

此外，我们希望以经济的方式实现这一目标。 一种可能性是在满足上述约束条件的情况下，将消耗的总燃料 $\Sigma_{t=0}^{T-1}|a_t|$ 最小化。 或者，我们可能希望最小化所需的最大推力，即 $max_t |a_t |$ 。 在任一选择下，问题都可以表述为线性规划问题（练习 1.6）。

### 1.4 Graphical representation and solution

在本节中，我们考虑一些简单的例子，这些例子提供了对线性规划问题本质的有用的几何见解。 我们的第一个示例涉及具有两个变量的线性规划问题的图形解决方案。

Example 1.6 Consider the problem 

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721120748301.png" alt="image-20210721120748301" style="zoom:50%;" />

可行集是图1.3中的阴影区域。为了找到最优解，我们进行如下操作。 对于任何给定的标量 $z$，我们考虑成本 $c'x$ 等于 $z$ 的所有点的集合； 这是等式$-x_1-x_2=z$ 所描述的直线 • 请注意，这条直线垂直于向量 $c=(-1,-1)$。 $z$ 的不同值会产生不同的线，它们都彼此平行。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721121314353.png" alt="image-20210721121314353" style="zoom: 67%;" />

特别地，增加 $z$ 会使直线 $z = - x_1  - x_ 2$ 沿向量 c 的方向移动，由于我们对最小化 $z$ 感兴趣，我们希望该直线尽可能多地沿 $- c$ 的方向移动，只要我们不离开可行区域。 我们能做的最小的情况是 $z = -2$（见图 1.3），向量 $x = ( 1 , 1 )$ 是一个最优解。 请注意，这是可行集的一个角。  （“角”的概念将在第 2 章正式定义。）

对于三维问题，可以使用相同的方法，只是具有相同 $c'x$ 值的点集现在是一个平面，而不是一条线。 这个平面再次垂直于向量 $c$，而我们的目标是尽可能在$-c$ 的方向上滑动这个平面，同时不离开可行集。 

Example 1.7 假设可行集是单位立方体，由约束 $0 \le x_i \le 1, i = 1 , 2 , 3$ 和 $c = (- 1 , - 1 , - 1 )$ 来刻画。 那么，向量 $x = ( 1 , 1 , 1 )$ 是一个最优解。 再一次，最优解恰好是可行集的一个角（图 1.4）。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721170706098.png" alt="image-20210721170706098" style="zoom:50%;" />

在前面的两个例子中，可行集是有界的（不会扩展到无穷大），并且问题有唯一的最优解。情况并非总是如此，下面的示例说明了一些其他可能性。

Example 1.8 Consider the feasible set in $\mathfrak{R}^2$ defined by the constraints

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721170927634.png" alt="image-20210721170927634" style="zoom:50%;" />

如图 1.5 所示

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721171010111.png" alt="image-20210721171010111" style="zoom:67%;" />

(a) 对于成本向量 $c = ( 1 , 1 )$ ，很明显 $x = (0, 0)$ 是唯一的最优解。

(b) 对于成本向量 $c = (1 , 0)$ ，有多个最优解，即 $x = (0, x_2 )$ 形式的每个向量 $x$ ，其中 $0 \le x_2 \le 1$ ，是最优的 . 请注意，最优解集是有界的。

(c) 对于代价向量 $c = (0, 1 )$ ，存在多个最优解，即，形式为 $x = (x_1 , 0)$ 且 $x_1 \geq 0$ 的每个向量 $x$ 都是最优的。 在这种情况下，最优解集是无界的（包含任意大小的向量）。

(d) 考虑成本向量 $c = (- 1 , - 1 )$ 。 对于任何可行解 $(x_1, x_2)$，我们总是可以通过增加 $x_1$ 的值，以更低的成本生成另一个可行解。 因此，没有可行的解决方案是最优的。 此外，通过考虑 $x_1$ 和 $x_2$ 值不断增加的向量 $(x_1 , x_ 2 )$，我们可以获得一系列可行解，其成本收敛到 $- \infin$ ，因此我们说最优成本是 $ - \infin$ 。

(e) 如果我们施加约束 $x_1  + x_2 \le - 2$ ，很明显不存在可行的解决方案。

总结从例 1.8 中获得的见解，我们有以下可能性

(a) 存在唯一的最优解。

(b) 存在多个最优解； 在这种情况下，最优解集可以是有界或无界的。

(c) 最优代价为 $- \infin$ ，没有可行解是最优的。

(d) 可行集为空。

原则上，还有一种可能：即使问题可行且最优代价不是 $- \infin$ ，也不存在最优解； 情况就是这样，例如，在使 $1/x$ 受 $x > 0$ 约束的最小化问题中（对于每个可行的解决方案，都存在另一个成本更低的问题，但最优成本不是 $-\infin$）。 我们将在本书后面看到这种可能性在线性规划中永远不会出现。

在我们考虑过的例子中，如果问题至少有一个最优解，那么可以在可行集的角中找到一个最优解。 在第 2 章中，我们将证明这是线性规划问题的一个普遍特征，只要可行集至少有一个角点。

##### Visualizing standard form problems

我们现在讨论一种方法，即使向量 $x$ 的维度 $n$ 大于 3，它也允许我们可视化标准形式的问题。 希望这样做的原因是，当 $n \le 3$ 时，标准形式问题的可行集没有太多变化，并且不能提供对一般情况的足够洞察。（相反，如果可行集由形式 $Ax \geq b$ 的约束描述，即使 $x$ 的维度为 3，也可以获得足够的多样性。）

假设我们有一个标准形式的问题，并且矩阵 $A$ 的维度为 $m\times n$  . 特别是，决策向量 $x$ 的维度为 $n$，我们有 $m$ 个等式约束。 我们假设 $m \le n$ 并且约束 $Ax = b$ 迫使 $x$ 位于 $(n - m)$ 维集合上（可以理解为，每一个线性无关的线性约束都会构成可行集空间中的一条基向量。直觉上，每个约束都会移除 $x$ 的“自由度”之一。）如果我们“站在”那个 $(n - m )$ 维集合上并忽略与其正交的 $m$ 维向量，则可行集仅受线性不等式约束 $x_i \geq0, i = 1, .  .  .  , n$ 。 特别地，如果 $n - m = 2$，则可行集可以绘制为由 $n$ 个线性不等式约束定义的二维集。

为了说明这种方法，考虑由约束 $x_1 + x_2 + x_3 = 1$ 和 $x_1 , x_2 , x_3 \geq 0$ 定义的 $\mathfrak{R}^3$ 中的可行集 [图 1.6 (a)] ，并注意 $n = 3$ 和 $m = 1$ 。 如果我们站在由约束 $ x_1 + x_2 + x_3 = 1$ 定义的平面上，那么可行集在二维空间中具有三角形的外观。 此外，三角形的每条边对应于约束 $x_1、x_2、x_3\geq0$； 见图1.6 (b)

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721211006906.png" alt="image-20210721211006906" style="zoom: 80%;" />

## Chapter 2 The geometry of linear  programming

在本章中，我们将多面体定义为由有限数量的线性等式和不等式约束描述的集合。 特别是，线性规划问题中的可行集是一个多面体。 我们详细研究了多面体的基本几何特性，重点是它们的“角点”（顶点）。 事实证明，当应用于高维多面体时，从熟悉的三维多面体导出的常见几何直觉基本上是正确的。 本章发展的另一个有趣方面是某些概念（例如，顶点的概念）可以通过几何或代数来定义。 虽然几何视图可能更自然，但代数方法对于执行计算是必不可少的。 该主题的大部分丰富性在于几何和代数观点之间的相互作用。

我们的开发始于以一般形式 $\{x | Ax \geq b\}$ 对可行集的角点进行表征。 稍后，我们关注可行集是标准形式 $\{x | Ax = b, x \geq 0\}$ 的情况，我们推导出角点的简单代数表征。 后一种表征将在第 3 章中单纯形方法的发展中发挥核心作用。

本章的主要结果表明，一个非空多面体至少有一个角点，当且仅当它不包含一条线，如果是这种情况，线性规划问题的最优解的搜索可以限制在角点上 . 这些结果在使用几何参数的线性规划问题的最一般情况下得到了证明。

同样的结果也将在下一章证明，对于标准形式问题的情况，作为我们发展单纯形方法的必然结果。 因此，希望关注标准形式问题的读者可以跳过第 2.5 和 2.6 节中的证明。最后，第 2.7 和 2.8 节也可以在第一次阅读时跳过； 稍后需要的这些部分中的任何结果将在第 4 章中使用不同的技术重新导出。

### 2.1 Polyhedral and convex sets

在本节中，我们将介绍一些将用于研究线性规划几何的重要概念，包括对凸性的讨论。

##### Hyperplanes, halfspaces, and polyhedra

我们从多面体的正式定义开始

定义 2.1 多面体是一个可以用 $\{x \in \mathfrak{R}^n | Ax \geq b\}$ 形式描述的集合，其中 $A$ 是一个 $m \times n$ 矩阵，$b$ 是 $\mathfrak{R}^m$ 中的向量

如第 1 节所述，如图 1 所示，任何线性规划问题的可行集都可以通过形式为 $Ax \geq b$ 的不等式约束来描述，因此其可行域可以被描述为一个多面体。 特别地，形式为$\{x \in \mathfrak{R}^n| Ax = b, x \geq 0\}$ 的集合也是多面体，被称作标准形式的多面体。

多面体可以“扩展到无限”，也可以限制在有限区域内。 下面的定义指的是这种区别

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721212707624.png" alt="image-20210721212707624" style="zoom:50%;" />

下一个定义处理由单个线性约束确定的多面体。

定义 2.3 设 $a$ 是 $\mathfrak{R}^n$ 中的一个非零向量，设 $b$ 是一个标量。

(a) 集合 $\{x \in \mathfrak{R}^n | a'x = b\}$ 被称为超平面。

(b) 集合 $\{ x \in \mathfrak{R}^n | a'x \geq b\}$ 被称为半空间。

请注意，超平面是相应半空间的边界。另外，超平面定义中的向量 $a$ 垂直于超平面本身。 最后，注意一个多面体等于有限个半空间的交集，见图2.1

##### Convex Sets

我们现在定义凸集

定义 2.4 一个集合 $S \subset \mathfrak{R}^n$ 是凸的，如果对于任何 $x, y \in S$, 和任何 $\lambda \in [0， 1]$, 我们有 $\lambda x + ( 1 - \lambda )y \in S$ 。

请注意，如果 $\lambda \in [0， 1]$ ，则 $\lambda x + ( 1 - \lambda )y $ 是向量 $x, y$ 的加权平均值，因此属于连接 $x$ 和 $y$ 的线段。 因此，如果连接其任意两个元素的线段包含在该集合中，则该集合是凸的； 见图2.2 .

我们的下一个定义是指有限数量向量的加权平均值； 见图2.3 .

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721213508838.png" alt="image-20210721213508838" style="zoom: 80%;" />

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721213558952.png" alt="image-20210721213558952" style="zoom:80%;" />

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721213609088.png" alt="image-20210721213609088" style="zoom:80%;" />

定义 2.5 令 $x^1, .  .  .  , x^k$ 是 $\mathfrak{R}^n$ 中的向量，令 $\lambda_1 , .  .  .  , \lambda_k$ 是总和为 1 的非负标量。

(a) 向量 $\Sigma_{i=1}^k\lambda_ix^i $ 被称为向量 $x^1,...,x^k$ 的凸组合。

(b) 向量 xl , 的凸包。  .  .  , xk 是这些向量的所有凸组合的集合。

下面的结果建立了一些与凸性相关的重要事实。

定理2.1

(a) 凸集的交集是凸集。

(b) 每一个多面体都是一个凸集。

(c) 凸集的有限个元素的凸组合也属于该集。

(d) 有限个向量的凸包是一个凸集。

### 2.2 Extreme points , vertices , and basic feasible solutions

我们在第 1.4 节中观察到，线性规划问题的最优解往往出现在我们正在优化的多面体的“角落”。 在本节中，我们提出了定义“角落”概念的三种不同方式，然后表明所有三种定义都是等价的。

我们的第一个定义将多面体的极值点定义为不能表示为多面体的其他两个元素的凸组合的点，如图 2.4 所示。 请注意，此定义完全是几何的，并不涉及多面体在线性约束方面的特定表示。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721230808076.png" alt="image-20210721230808076" style="zoom:50%;" />

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721230823478.png" alt="image-20210721230823478" style="zoom: 80%;" />

另一种几何定义将多面体 P 的顶点定义为某些具有可行集 P 的线性规划问题的唯一最优解。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721230849608.png" alt="image-20210721230849608" style="zoom:50%;" />

换句话说，$x$ 是 $P$ 的一个顶点，当且仅当 $P$ 位于仅在点 $x$ 处与 $P$ 相交的超平面（超平面 ${y | c'y = c'x}$）的一侧； 见图 2.5。

从算法的角度来看，我们迄今为止给出的两个几何定义并不容易处理。 我们希望有一个定义，它依赖于多面体在线性约束方面的表示，并简化为代数测试。 为了提供这样的定义，我们需要更多的术语。

考虑根据线性等式和不等式约束定义的多面体 $P \subset \mathfrak{R}^n$

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721231251029.png" alt="image-20210721231251029" style="zoom:50%;" />

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721231323241.png" alt="image-20210721231323241" style="zoom:80%;" />

定义 2.8 如果对于 $M_1$ 、$M_2$ 或 $M_3$ 中的某些 $i$，向量 $x^*$ 满足 $a'x^* = b_i$，我们说相应的约束在 $x^*$ 处是有效的的或绑定的。

如果在向量 $x^*$ 处有 $n$ 个有效约束，则 $x^*$ 满足一个包含有 $n$ 个未知数的 $n$ 个线性方程构成的特定系统。 当且仅当这 $n$ 个方程“线性无关”时，该系统才有唯一解。 下面的结果给出了这个陈述的精确含义，以及一个轻微的概括。

定理2.2 令 $x^*$ 是 $\mathfrak{R}^n$ 上的一个元素，并令 $I = \{i | a_i'x^* = b_i\}$ 是在 $x^*$ 处**有效**的约束的索引集。 则以下命题等价： 

(a) 集合 $\{a_i | i \in I\}$ 中存在 $n$ 个线性无关的向量。

(b) 向量 $a_i , i \in I$ 的可以张得 $\mathfrak{R}^n$ ，也就是说， $\mathfrak{R}^n$ 的每个元素都可以表示为向量 $a_i , i \in I$ 的线性组合。

(c) 方程组 $a_i'x = b_i , i \in I$ 有一个唯一解。

我们经常会说某些约束是线性无关的，这意味着相应的向量 $a_i$ 是线性无关的。 使用这个术语，定理 2.2 中的语句 (a) 要求存在 $n$ 个在 $x^*$ 处有效的线性独立约束。

我们现在准备提供一个角点的代数定义，作为一个可行的解决方案，其中有 $n$ 个线性无关的有效约束。请注意，由于我们对可行的解决方案感兴趣，因此所有等式约束都必须处于有效状态。 这提出了以下寻找角点的方法：首先施加等式约束，然后要求足够多的附加约束处于有效状态，这样我们总共得到 $n$ 个线性无关的有效约束。 一旦我们有 $n$ 个线性无关的活动约束，一个唯一的向量 $x^ *$ 就被确定了（定理 2.2）。 然而，这个过程不能保证得到一个可行的向量 $x^ *$ ，因为一些非活动约束可能会被违反； 在后一种情况下，我们说我们有一个基本的（但不是基本可行的）解决方案。

定义 2.9 考虑一个由线性等式和不等式约束定义的多面体 $P$，记 $x^ *$ 是 $\mathfrak{R}^n$ 的一个元素。

(a) 向量 $x^ *$ 是一个基本解，如果： (i) 所有等式约束都有效；  (ii) 在 $x^*$ 处有效的约束中，有 n 个线性无关。

(b) 如果 $x^ *$ 是满足所有约束的基本解，我们说它是基本可行解

参考图 2.6，我们注意到 A、B 和 C 点是基本可行解，点 D 不是基本解，因为它不满足等式约束。  E 点是可行的，但不是基本的。 如果等式约束 $x_1 + x_2 + x_3 = 1$ 被约束 $x_1 + x_2 + x_3\le 1$ 和 $x_1 + x_2 + x_3 \geq1$ 替换，那么根据我们的定义，D 将是基本解。 这表明点是否是基本解可能取决于多面体的表示方式。
   定义 2.9 也在图 2 中说明。  7.
   请注意，如果用于定义多面体 P C 3?n 的约束数 m 小于 n，则任何给定点的活动约束数也必须小于 n，并且不存在基本或基本可行解。
   到目前为止，我们已经给出了三个不同的定义，旨在捕捉相同的概念； 其中两个是几何（极值点，顶点），第三个是代数（基本可行解）。 幸运的是，正如我们接下来证明的那样，所有三个定义都是等效的，因此，这三个术语可以互换使用。



































































































































































## Chapter 3 The simplex method

我们在第 2 章中看到，如果一个标准形式的线性规划问题有一个最优解，那么就存在一个最优的基本可行解。 单纯形法基于这一事实，通过从一个基本可行解移动到另一个基本可行解，沿着可行集的边缘，始终朝着降低成本的方向寻找最优解。 最终，达到了一个基本可行的解决方案，在该解决方案中，没有可用的边会导致成本降低； 这样的基本可行解是最优的，算法终止。 在本章中，我们提供了单纯形方法的详细发展并讨论了几种不同的实现，包括单纯形表和修改后的单纯形方法。 我们还解决了存在退化时可能出现的一些困难。 我们根据柱几何对单纯形法进行了解释，最后讨论了它的运行时间，作为所解决问题的维度的函数。

在本章中，我们考虑标准形式问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210722002437488.png" alt="image-20210722002437488" style="zoom:50%;" />

我们令 $P$ 为对应的可行集。 我们假设矩阵 $A$ 的维度是 $m \times n$ 并且它的行是线性无关的。我们继续使用之前的记号：$A_i$ 是矩阵 $A$ 的第 $i$ 列，$a_i'$ 是它的第 $i$ 行。

### 3.1 Optimality conditions

许多优化算法的结构如下：给定一个可行解，我们搜索它的邻域以找到一个成本较低的邻近可行解。 如果附近没有可行的解决方案导致成本改进，则算法终止，我们有一个局部最优解。 对于一般优化问题，局部最优解不一定是（全局）最优的。 幸运的是，在线性规划中，局部最优意味着全局最优； 这是因为我们要最小化凸集上的凸函数（参见练习 3.1）。 在本节中，我们专注于在给定基本可行解的邻域中寻找成本降低方向的问题，以及相关的最优性条件 。

假设我们在一个点 $x \in P$ 并且我们考虑从 x 移开，沿向量 $d\in\mathfrak{R}^n$ 的方向移动。 显然，我们应该只考虑那些不会立即将我们带出可行集的 $d$ 。 这导致以下定义，如图 3.1 所示。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210722010759564.png" alt="image-20210722010759564" style="zoom:80%;" />

定义 3.1 设 $x$ 是多面体 $P$ 的一个元素。如果存在一个正标量 $\theta$ 使得 $x + \theta d \in P$ ，则称向量 $d\in\mathfrak{R}^n$ 是 $x$ 处的可行方向。

令 $x$ 是标准形式问题的基本可行解，令 $B ( 1 ) , .  .  .  , B (m)$ 是基变量的索引，让 $B = [A_{B(1)} ,  .  . . ,A_{B(m)}]$ 是相应的基矩阵。 特别地，对于每个非基变量，我们有 $x_i = 0$，而基本变量的向量 $x_B = (x_{ B(1)} , . . . , x _{B(m)} )$ 由下式给出

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210722011211870.png" alt="image-20210722011211870" style="zoom:50%;" />

我们考虑了从 $x$ 移到新向量 $x + \theta d$ 的可能性，方法是选择一个非基变量 $x_j$（最初处于零水平），并将其增加到一个正值 $\theta$，同时保持剩余的非基变量为零。 在代数上，对于除 $j$ 之外的每个非基本索引都有，$d_j = 1$ 和 $d_i = 0$ 。同时，基本变量的向量 $x_B$ 变为 $x_B + \theta d_B$ ，其中 $d_B = (d_{B(1)} , d_{B(2)} , .. . , d_{B(m)} )$ 是与 d 的那些分量对应的向量 到基本变量。

鉴于我们只对可行解感兴趣，我们需要 A(x + ed) = b，并且由于 x 是可行的，我们也有 Ax = b。 因此，为了满足 e > 0 的等式约束，我们需要 Ad = o。 现在回想一下，对于所有其他非基本索引 i，dj = 1 和 di = 0。 然后





















































































