# Introduction to Linear Optimization 

### Preface

本书的目的是对线性优化（即线性规划、网络流问题和离散线性优化）提供统一的、有见地的和现代的处理方法。 我们既讨论经典话题，也讨论最新技术。 我们特别关注理论，但也涵盖应用和当前案例研究。 我们的主要目标是帮助读者成为（线性）优化的资深实践者或研究人员。 更具体地说，我们希望培养制定相当复杂的优化问题的能力，提供对实际可解决的主要问题类别的评价，描述可用的解决方法，并建立对它们提供的解决方案的定性属性的理解。

我们的总体理念是洞察力最重要。 对于本书的主题，这必然需要几何视图。 另一方面，问题是由算法解决的，而这些只能用代数来描述。 因此，我们的重点是代数和几何之间的美丽相互作用。 我们使用图形和几何参数建立理解，然后将想法转化为代数公式和算法。 如果有足够的时间，我们希望读者能够毫不费力地培养从一个域到另一个域的能力。

我们的另一个目标是全面但经济。 我们已努力涵盖和突出该领域的所有主要思想。 然而，我们并没有试图成为百科全书，或者讨论与特定算法相关的每一个可能的细节。 我们的前提是，一旦对基本原理有了成熟的理解，读者就可以毫不费力地获得更多的细节。

我们的最后一个目标是让读者了解最新技术。 在我们处理内点方法、大规模优化以及扩展当前可用算法和计算机极限的案例研究的介绍中尤其如此。

任何优化方法的成功与否都取决于其处理大型重要问题的能力强弱。 从这个意义上说，关于线性优化艺术的最后一章是本书的关键部分。 我们希望它能让读者相信，在挑战性问题上取得进展既需要对问题的洞察力，也需要对基本理论有更深入的理解。

在任何处理线性规划的书中，都有一些关于**单纯形法**处理的重要选择。传统上，单纯形方法是根据完整单纯形表开发的，这往往成为中心主题。 我们发现完整的单纯形表是计算数值例子的有用工具，但除此之外，我们尽量不过分强调它的重要性。

与许多其他教科书的另一个不同之处在于，介绍性处理通常侧重于标准形式问题（理想形态的问题），这对于单纯形方法的目的来说已经足够了。 另一方面，这种方法常常让读者想知道某些属性（即，这些理性模型中所假设的参数或由此推算出的结论）是否通常为真，并且会阻碍对主题的更深入理解。 我们背离了这一传统：我们考虑线性规划问题的一般形式并在此上下文中定义关键概念（例如极值点）。  （当然，当谈到算法时，我们往往不得不专攻标准形式。）本着同样的精神，我们将线性规划的结构理解与单纯形方法的细节分开。 例如，我们包含了不依赖单纯形方法的对偶理论的推导。

最后，本书包含对几个通常不涉及的重要主题的处理。 其中包括对柱几何及其对单纯形法效率的见解的讨论、对偶性与金融资产定价之间的联系、延迟柱生成和切割平面方法的统一视图、随机规划和 Benders 分解 ，分配问题的拍卖算法，椭球算法的某些理论含义，对内点方法的彻底处理，以及关于线性优化实践的一整章。 练习中还涵盖了几个值得注意的主题，例如 Leontief 系统、严格互补性、期权定价、冯诺依曼算法、子模函数最小化以及许多整数规划问题的边界。

下面是对本书的逐章描述

第 1 章：介绍线性规划问题以及一些示例，并提供一些有关线性代数的背景资料。

第 2 章：处理多面体的基本几何性质，重点关注极值点的定义和存在，并强调几何和代数观点之间的相互作用。

第 3 章：或多或少包含与单纯形法相关的经典材料，以及对柱几何的讨论。 它从单纯形方法的高级和几何驱动推导开始。 然后介绍修改后的单纯形法，并以单纯形表结束。

第 4 章：综合处理线性规划对偶性。对偶定理首先作为单纯形方法的推论得到。 还提供了更抽象的推导，基于分离超平面定理，该定理是从第一原理发展而来的。 它以对多面体几何形状的更深入研究结束。

第 5 章：讨论敏感性分析，即解决方案和最优成本对问题数据的依赖性，包括参数规划。 它还开发了双重最优解的特征，作为适当定义的最优成本函数的次梯度。

第 6 章：介绍延迟列生成和切割平面的补充思想。 这些方法首先是在高层次上开发的，然后通过讨论下料问题、Dantzig-Wolfe 分解、随机规划和 Benders 分解来具体化。

第 7 章：全面回顾了网络流问题不同变体的主要结果和方法。 它包含所有主要或类型算法的代表：原始下降（单纯形方法）、双重上升（原始-双重方法）和近似双重上升（拍卖算法）。 重点是主要的算法思想，而不是可以导致更好的复杂性估计的改进。

第 8 章：包括对复杂性的讨论、椭球法的发展以及线性规划多项式的证明。 它还讨论了分离和优化的等价性，并提供了示例，其中椭球算法可用于为涉及指数数量约束的问题导出多项式时间结果。

第 9 章：包含所有主要类别的内点方法的概述，包括仿射缩放、潜在约简和路径跟踪（原始和原始对偶）方法。 它包括对基本几何思想和计算问题的讨论，以及收敛证明和复杂性分析。

第 10 章：介绍离散优化问题的整数规划公式。 它提供了许多示例，以及关于什么构成“强”公式的一些直觉。

第11章：涵盖整数规划算法的主要或类别，包括精确方法（分支定界、切割平面、动态规划）、近似算法和启发式方法（局部搜索和模拟退火）。 它还介绍了整数规划的对偶理论。

贯穿几章的一个重要主题是指数数约束问题的建模、复杂性和算法。 我们在第 10.3 节讨论建模，第 8.5 节讨论复杂性，第 6 章和第 8.5 章讨论算法方法，并在第 12.5 节以案例研究结束。

每章末尾都有相当数量的练习。 它们大多是为了加深对主题的理解，或探索课文中理论的扩展，而不是常规练习。 但是，还包括几个数值练习。加星标的练习应该相当困难。 可以从作者处获得适用于合格教师的解决方案手册。

我们特别努力使文本尽可能模块化，允许读者在不失去连续性的情况下省略某些主题。 例如，本书其余部分很少使用第 5 章和第 6 章中的大部分材料。 此外，在第 7 章（关于网络流问题）中，已经完成了问题表述（第 7.1-7.2 节）的读者可以立即转到该章的任何后面的部分。 另外，第 9 章的内点算法在后面也没有用到，除了第 12 章中的一些应用。 即使在核心章节（第 1-4 章）中，也有很多章节可以在初读时跳过 . 某些部分已标有星号，表明它们包含一些通常不包含在介绍性课程中的更高级的材料。

这本书是在我们轮流在 M.I.T 教授一年级研究生课程时编写的，适用于工程和运筹学专业的学生。唯一的先决条件是线性代数的工作知识。 事实上，它只需要线性代数的一个小子集（例如，子空间的概念、线性独立性和矩阵的秩）。然而，这些基本工具有时会以微妙的方式使用，读者在数学上的一些成熟可以导致对主题的更好理解。

这本书可用于教授几种不同类型的课程。 下面的前两个建议是我们在 M.I.T 尝试过的一个学期的变体，但也有其他有意义的选择，具体取决于学生的背景和课程目标。

(a) 涵盖第 1-7 章的大部分内容，如果时间允许，涵盖第 9-12 章的少量主题

(b) 替代方案可能与上述相同，除了内点算法（第 9 章）被完全覆盖，取代了网络流问题（第 7 章）。

(c) 可以通过集中在大多数章节中较简单的材料来构建广泛的概述课程。 此类课程的核心可能包括第 1 章第 2 节。2.1-2.4、3.1-3.5、4.1-4.3、5.1、7.1-7.3、9.1、10.1，以及章节中的一些较简单的材料 11 ，以及第 12 章中的应用程序。

(d) 最后，本书也适用于整数规划的半课程，基于第 1 章和第 8 章以及第 10-12 章的部分内容。

有大量关于线性优化的文献，我们不尝试提供全面的参考书目。 在很大程度上，我们引用的来源要么是具有历史意义的原始参考资料，要么是可以找到附加信息的近期文本。 然而，对于那些涉及当前研究的主题，我们还提供了指向最近的期刊文章的指针。

我们要向一些人表示感谢。 我们感谢我们的同事 Dimitri Bertsekas 和 Rob Freund，他们对本书中的主题进行了多次讨论，并阅读了部分手稿。 我们的一些学生、同事和朋友通过阅读部分手稿、提供批判性评论和练习练习做出了贡献：Jim Christodouleas、Thalia Chryssikou、Austin Frakt、David Gamarnik、Leon Hsu、Spyros Kontogiorgis、Peter Marbach、Gina  Mourtzinou、Yannis Paschalidis、Georgia Perakis、Lakis Polymenakos、Jay Sethuraman、Sarah Stock、Paul Tseng 和 Ben Van Roy。但最重要的是，我们感谢我们的家人在这个漫长的项目过程中的耐心、爱和支持。

## Chapter 1 Introduction

在本章中，我们介绍线性规划，即在线性等式和不等式约束下最小化线性成本函数的问题。我们考虑一些等价形式，然后提供一些示例来说明线性规划在各种上下文中的适用性。 我们还解决了一些简单的例子，并对问题的性质获得了一些基本的几何直觉。 本章最后回顾了线性代数和用于描述算法的计算要求（操作数）的约定。

### 1.1 Variants of the linear programming problem

在本节中，我们提出线性规划问题，讨论它采用的一些特殊形式，并建立一些我们将使用的标准符号。 我们不是抽象地开始，而是首先陈述一个具体的例子，它旨在促进对后面的正式定义的理解。 我们给出的例子没有任何解释。 稍后，在第 1.2 节中，我们将有充足的机会开发实际环境中出现的示例。

Example 1 . 1 The following is a linear programming problem

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720135704696.png" alt="image-20210720135704696" style="zoom: 50%;" />

这里 $x_1、x_2、x_3$ 和 $x_4$ 是变量，其值将被选择以最小化线性成本函数 $2x_1 - x_2 + 4x_3$，该函数受一组线性等式和不等式约束。 其中一些约束，例如 $x_1\ge0$ 和 $x_3 \le 0$ ，相当于对某些变量的符号的简单限制。 其余约束的形式为 $a'x \le b$、$a'x = b$ 或 $a'x \geq b$ ，其中 $a = (a_1 , a_2 , a_3 , a_4 )$ 是给定的系数向量（注1） , $x = (x_l  , x_2 , x_3 , x_4)$ 是决策变量的向量，$a'x$ 是它们的内积 $\Sigma_{i=1}^4a_ix_i$ ，而 $b$ 是给定的标量 。 例如，在第一个约束中，我们有 $a = ( 1 , 1 , 0 , 1 )$ 和 $b = 2$。

注1：正如第 1.5 节中进一步讨论的，所有向量都被假定为列向量，并在矩阵向量乘积中被如此对待。 行向量表示为（列）向量的转置。 然而，每当我们在文本中引用向量 x 时，我们都会使用更经济的符号 $x = (x_1, ... , x_n )$，即使 $x$ 是一个列向量。不熟悉我们的符号的读者可能希望在继续之前查阅第 1.5 节。

现在可以如此概括，在一般线性规划问题中，我们给定了一个成本向量 $c = (c_1, . . , c_n)$ 并且我们寻求可以最小化线性成本函数 $c'x = \Sigma_{i=1}^nc_ix_i $ 的 $n$ 维向量 $x=(x_1,...,x_n)$，并且该向量服从一组线性等式和不等式约束。 特别地，让 $M_I$, $M_2$, $M_3$ 是一些有限索引集（设 $\mathtt{A}$ 是一个非空集合，对于每个 $α ∈\mathtt{A}$，设 $A_α$ 是一个集合。 那么$\{A_α;  α ∈ \mathtt{A}\}$ 称为集合族，$\mathtt{A}$ 是该族的索引集**(index set)**），并假设对于这些集合中的任何一个中的每个 $i$，我们都被赋予了一个 $n$ 维向量 $a_i$ 和一个标量 $b_i$ ，它们将用于形成第 $i$ 个 约束。 假设 $N_1$ 和 $N_2$ 是 $\{1,  .  .  , n\}$ 的子集，对于左侧集合中的编号而言，他们给定了决策变量 $x_j$ 的正负性。 然后我们考虑问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720144937371.png" alt="image-20210720144937371" style="zoom: 50%;" />

变量 $x_1 , .  .  .  , x_n$ 称为决策变量，满足所有约束条件的向量 $x$ 称为可行解或可行向量，所有可行解的集合称为可行集或可行域。如果 $j$ 既不在 $N_1$ 也不在 $N_2$ 中，则 $X_j$ 的符号没有限制，在这种情况下，我们说 $X_j$ 是一个自由或不受限制的变量。 函数 $c'x$ 称为目标函数或成本函数。 最小化目标函数的可行解 $x^*$（即 $c'x^* \le c'x$，​对于所有可行的 $x$）被称为最优可行解，或者简称为最优解。 然后将 $c'x^*$ 的值称为最优成本。 另一方面，如果对于每一个实数 $K$ 我们都可以找到一个可行解 $x$ 使其成本小于 $K$，我们说最优成本是 $-\infin$ 或成本是无下界的。（有时，我们会滥用术语，说问题是无界的。）我们最后注意到，没有必要单独研究最大化问题，因为最大化 $c'x$ 等效于最小化线性成本函数 $-c'x$。

一个等式约束 $a'_ix = b_i$ 等价于两个约束 $a_i'x \geq b_i$ 和 $a_x'\le b_i$ 此外，任何形式为 $a_i'x \le b_i;$ 的约束条件，都可以改写为 $(-a_i )'x\geq -b_i$。 最后，$x_j \geq 0$ 或 $x_j \le 0$ 形式的约束都是 $a_i'x \geq b_i$ 的特殊情况，其中 $a_i'$ 是单位向量，$b_i = 0$。假设总共有 $m$ 个这样的约束，由 $i = 1 , ... , m$ 索引，让 $b = (b_1 , ... , b_m)$，并让 A 是 $m\times n$ 矩阵，其行是行向量 $a_1'   , ... , a_m'$ , 即 , 

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150115067.png" alt="image-20210720150115067" style="zoom: 50%;" />

那么，约束 $a_i' x \geq b_i , i = 1 , ... , m$, 可以简洁地表示为 $Ax \geq b$ 的形式，线性规划问题可以写成

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150311713.png" alt="image-20210720150311713" style="zoom: 50%;" />

诸如 $Ax \geq b$ 之类的不等式将始终按分量进行解释； 也就是说，对于每个 $i$ ，向量 $Ax$ 的第 $i$ 个分量，即 $a_i'x$，大于或等于向量 $b$ 的第 $i$ 个分量 $b_i$。

Example 1.2 The linear programming problem in Example 1.1 can be rewritten as

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150445183.png" alt="image-20210720150445183" style="zoom: 50%;" />

这与问题 (1.2) 的形式相同，其中 c = (2, - 1 , 4, 0) ，

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150628980.png" alt="image-20210720150628980" style="zoom:50%;" />

##### Standard form problems

一般的线性规划问题包含有下面的形式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150725660.png" alt="image-20210720150725660" style="zoom:50%;" />

该形式被称为其标准形式。 我们以标准形式提供问题的解释。 假设 $x$ 的维度为 $n$ 并s设 $A_1 ,   .  .  , A_n$ 是 $A$ 的列。 那么约束 $Ax = b$ 可以写成

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720150851634.png" alt="image-20210720150851634" style="zoom:50%;" />

直观地说，有 $n$ 个可用的资源向量 $A_1 ,.  .  . , A_n$ , 和一个目标向量 $b$. 我们希望通过使用每个资源向量 $A_i$ 的非负倍数 $x_i$ 来“合成”目标向量 $b$，同时最小化成本 $\Sigma_{i=1}^nc_ix_i$ ，其中 $c_i$ 是第 $i$ 个资源的单位成本。 下面是一个更具体的例子。

Example 1.3 （饮食问题）假设有 $n$ 种不同的食物和 $m$ 种不同的营养成分，下表中给出了食物的种类和其对应的营养成分种类及其含量

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720151411312.png" alt="image-20210720151411312" style="zoom:67%;" />

设 $A$ 为元素为 $a_{ij}$ 的 $m \times n$ 矩阵。 请注意，该矩阵的第 $j$ 列 $A_j$ 表示第 $j$ 种食物的营养成分。 让 $b$ 是一个具有理想饮食要求的向量，或者等价地，一个“理想食物”的营养成分的规范。 然后我们将标准形式问题解释为混合可用食物的非负数量 $x_i$ 的问题，并以最小成本合成理想食物。 在这个问题的一个变体中，向量 $b$ 指定了充足饮食的最低要求； 在这种情况下，约束 $Ax = b$ 被 $Ax \geq b$ 替换，并且问题不是标准形式。

##### Reduction to standard form

如前所述，任何线性规划问题，包括标准形式问题 (1.3) ，都是一般形式 (1.1) 的特例。 我们现在认为反过来也是正确的，并且一般线性规划问题可以转换为标准形式的等价问题。

在这里，当我们说这两个问题是等价的时，我们的意思是，给定一个问题的可行解，我们可以以相同的代价构造另一个问题的可行解（即，构造这两个问题的可行解的代价相同）。 特别地，这两个问题具有相同的最优成本，并且给定一个问题的最优解，我们可以构造另一个问题的最优解。 我们想到的问题转化包括两个步骤：

(a) 消除自由变量：在一般形式的问题中给定一个不受限制的变量 $x_j$，我们可以用 $x_j^+ - x_j^-$ 替换它，其中 $x_j^+$ 和 $x_j^-$ 是我们施加符号约束 $x_j^+\geq 0$ 和 $x_j^-\geq 0$ 的新变量 . 基本思想是任何实数都可以写成两个非负数的差。

(b) 消除不等式约束：给定形式为不等式约束

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152107103.png" alt="image-20210720152107103" style="zoom:50%;" />

我们引入了一个新的变量 $s_i$ 以形成标准形式的约束

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152157249.png" alt="image-20210720152157249" style="zoom:67%;" />

这种变量 $s_i$ 被称为松弛变量。 类似地，不等式约束 $\Sigma_{j=1}^na_{ij}x_j\geq b_i$ 可以通过引入一个剩余变量（surplus variable) $s_i$ 以变为标准形式的约束 $\Sigma_{j=1}^na_{ij}x_j-s_i= b_i$

我们得出结论，一般问题都可以转变为标准形式，因此，我们只需要开发能够解决标准形式问题的方法

Example 1.4 The problem

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152824141.png" alt="image-20210720152824141" style="zoom:50%;" />

等价于标准形式问题

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210720152915960.png" alt="image-20210720152915960" style="zoom: 50%;" />

例如，给定原问题的可行解 $(x_1  , x_2 )$ $= (6, -2)$，我们得到可行解 $(x_1 , x_2^+ , x_2^-, x_3 ) = (6, 0, 2  , 1 )$ 这两者的成本相同。 反之，给定标准形式问题的可行解 $(x_1 , x_2^+, x_2^-, x_3) = (8, 1 , 6 , 0)，$我们得到可行解 $(x_ 1 , x_2 ) = (8, -  5）$ 同样会以相同的成本解决原来的问题。

在后续中，我们会经常使用一般形式 $Ax \geq b$ 来发展线性规划理论。 然而，当谈到算法时，尤其是单纯形法和内点法时，我们将重点关注标准形式 $Ax = b, x\geq 0$，它在计算上更方便。

### 1.2 Examples of linear programming problems

在本节中，我们将讨论一些线性规划问题的示例。 我们的目的之一是指出可以应用线性规划的广泛情况。 另一个目的是熟悉构建松散定义优化问题的数学公式的艺术

##### A production problem

一家公司使用 $m$ 种不同的原材料生产 $n$ 种不同的商品。 记 $b_i , i = 1, ...  , m$ 是第 $i$ 种原料的可用量。 第 $j$ 个商品 $j = 1, ... , n$ 需要 $a_{ij}$ 单位的第 $i$ 种材料并导致每生产单位的收入为 $c_j$。 公司面临的问题是决定生产多少每种商品以使其总收入最大化。

在这个例子中，决策变量的选择很简单。 设 $x_j , j = 1, .  .  .  , n$ 是第 j 个商品的数量。 那么，企业面临的问题可以表述为：

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721000159600.png" alt="image-20210721000159600" style="zoom: 50%;" />

##### Production planning by a computer manufacturer

我们在此考虑的示例是 Digital Equipment Corporation (DEC) 在 1988 年第四季度面临的一个问题。它说明了现实世界应用程序的复杂性和不确定性，以及数学建模对制定重要战略决策的有用性。

1988 年第二季度，DEC 推出了一个新的（单 CPU）计算机系统和工作站系列：GP-1、GP-2 和 GP-3，它们分别具有不同的内存、磁盘存储大小和扩展能力，作为工作站的 WS-1 和 WS-2 这两款产品也一样。 在表 1. 1 中，我们列出了型号、标价、每个系统的平均磁盘使用量和内存使用量。 例如，GP-l 使用四块 256K 内存板，每 10 个产品中有 3 个会包含磁盘驱动器（这基于客户的需求，原始产品并不包含此项）。

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721000409570.png" alt="image-20210721000409570" style="zoom:50%;" />

这个新产品系列的出货将从第三季度开始，并在第四季度缓慢增长。 预计下一季度将面临以下困难：

(a) 由于调试问题，内部 CPU 供应商最多可以提供 7,000 个单元。

(b) 磁盘驱动器的供应不确定，制造商估计在 3,000 至 7,000 台之间。

(c) 256K 内存板的供应也被限制在 8,000 至 16,000 块的范围内。

在需求方面，市场部确定1989一季度的最大需求为GP-1系统1800台、GP-3系统300台、GP全系3800台以及3200台 WS 系列的系统。 这些预测包括 500 份 GP-2 订单、500 份 WS-1 订单和 400 份 WS-2 订单，这些订单已经收到并必须在下个季度完成。

在前几个季度，为了解决磁盘驱动器短缺的问题，DEC 生产了没有磁盘驱动器的 GP-1、GP-3 和 WS-2（尽管 GP-1 系统的 10 个客户中有 3 个想要磁盘驱动器）, GP-2, WS-1 带一个磁盘驱动器。 我们将这种配置系统的方式称为**受约束的生产模式**。

此外，DEC 在GP-1 系统中使用可以通过在每个系统中使用两块备用的 256K 数据版以解决数据版短缺的问题。  DEC 可以在下个季度提供 4,000 个替代板。

制造人员很清楚问题已经变得复杂，因为收入、盈利能力和客户满意度都处于危险之中。需要做出以下决定：

(a) 1989年第一季度的生产计划。

(b) 关于磁盘驱动器的使用，DEC 应该继续在受限模式下生产产品，还是应该计划满足客户的喜好？

(c) 关于内存板，DEC 是否应该为其 GP-1 系统使用替代内存板？

(d) 必须做出的最终决定与磁盘驱动器短缺和 256K 内存板短缺之间的权衡有关。 制造人员想集中精力减少磁盘短缺的影响或减少256K内存板短缺的影响。 因此，他们想知道哪种替代方案会对收入产生更大的影响。

为了模拟 DEC 面临的问题，我们引入了变量 $x_1、x_2、x_3、x_4、x_5$，它们代表 GP-1、GP2、GP-3、WS-1 和 WS-2 的数量（以千计），分别将在下个季度生产。 严格来说，由于 $1000x_i$ 代表单位1，所以它（指的是 $1000x_i$ ） 必须是一个整数。 这可以通过截断每个 $x_i$ 第三个小数点后来实现； 考虑到需求的大小以及变量 $x_i$ 的大小，这具有可以忽略不计的影响并且可以忽略对 $1000x_i$ 的完整性约束。

DEC 必须做出两个截然不同的决定：是否使用有关磁盘驱动器使用的受限生产模式，以及是否为 GP-1 系统使用替代内存板。 因此，有四种不同的可能选择组合。

我们首先为不使用替代内存板并选择磁盘驱动器生产受限模式的情况开发模型。 该问题可以表述如下： 

![image-20210721001942369](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721001942369.png)

请注意，目标函数的值在数百万美元。 在某些方面，这是一个悲观的表述，因为 256K 内存和磁盘驱动器可用性分别设置为 8 和 3，这是估计范围内的最低值。 确定此问题的解决方案实际上很有趣，因为 256K 内存可用性范围为 8 到 16，而磁盘驱动器可用性范围为 3 到 7，因为这提供了有关最佳解决方案对可用性的敏感性的宝贵信息。 在另一个方面，该公式是乐观的，例如，它假设 GP-1 系统的收入对于任何 $x_1\le1.8$; 都是 $60k$ ，即使不能保证每一个客户对 1,800 台 GP-1 系统的个性化需求。

为了适应 DEC 的其他三个选择，必须修改一些问题约束，如下所示。 如果我们对磁盘驱动器使用无约束生产模式，则约束 $x_2+x_4 \le 3$ 被替换为

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721002356433.png" alt="image-20210721002356433" style="zoom: 50%;" />

此外，如果我们希望在 GP-1 系统中使用替代内存板，我们将替换约束 $4x_1+2x_2+2x_3+2x_4+x_6\le8$ 为新的两个约束条件

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721002528611.png" alt="image-20210721002528611" style="zoom: 50%;" />四种选择组合导致四种不同的线性规划问题，每一种都需要针对不同的参数值求解，因为如前所述，某些约束的右侧只知道位于特定范围内。当某些参数允许在某个范围内变化时，求解线性规划问题的方法将在第 5 章中进行研究，并在此案例研究中重新讨论

##### Multiperiod planning of electric power capacity

一个州想要规划其未来 $T$ 年的电力容量。 该州对 $t = 1 , .  .  ，T$ 年的电力需求预测为 $d_t$ 兆瓦，假定准确。而现有的电力容量（燃油电厂）将不会在未来的 $t$ 年内损毁，并且假设其每年的发电容量不会发生变化，该值记为 $e_t$ 。 扩大电力容量有两种选择：新建燃煤电厂或核电厂。 燃煤电厂在 $t$ 年初投入运营的每兆瓦燃煤容量的资本成本为 $c_t$。核电站的相应资本成本为 $n_t$ 。 出于各种政治和安全原因，已决定核电容量不得超过总容量的 20%。 燃煤电厂的使用寿命为 20 年，而核电厂的使用寿命为 15 年。 需要一个成本最低的容量扩展计划。

将此问题表述为线性规划问题的第一步是定义决策变量。 设 $x_t$ 和 $y_t$ 是 t 年初上线的煤炭（核能）装机量。 设 $w_t$ 和 $z_t$ 是 $t$ 年可用的煤炭（核能）装机总量。 因此，容量扩展计划的成本是，

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003237438.png" alt="image-20210721003237438" style="zoom: 50%;" />

因为燃煤电厂可以持续运营 20 年，我们有

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003441615.png" alt="image-20210721003441615" style="zoom:67%;" />

同样，对于核电站

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003545600.png" alt="image-20210721003545600" style="zoom:50%;" />

由于可用容量必须满足预测的需求，我们要求

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003642005.png" alt="image-20210721003642005" style="zoom:50%;" />

最后，由于核电不应超过总容量的 20%，我们有

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003713836.png" alt="image-20210721003713836" style="zoom:50%;" />

可以写成

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003818971.png" alt="image-20210721003818971" style="zoom:50%;" />

总结一下，扩容问题如下

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721003843697.png" alt="image-20210721003843697" style="zoom:50%;" />

我们注意到这种表述并不完全现实，因为它忽略了可能有利于大型工厂的某些规模经济。 但是，它可以提供对真实成本的大致估计

##### A scheduling problem

在前面的例子中，决策变量的选择相当简单。 我们现在讨论这个选择不太明显的例子。一家医院希望为其护士制定每周夜班（中午 12 点至早上 8 点）的时间表。 第 $j$ 天夜班护士的需求是一个整数 $d_j$ , $j = 1 , .  .  .  , 7$. 每个护士连续工作 5 天夜班。 问题是找到医院需要雇用的最少数量的护士。

可以尝试使用等于在第 $j$ 天工作的护士数量的决策变量 $y_j$。 然而，根据这个定义，我们无法捕捉到每个护士连续工作 5 天的约束。 出于这个原因，我们选择不同的决策变量，即定义变量 $x_j$ ，其数值大小为在 $j$ 天开始工作的护士数量。（例如，一周从第 5 天开始的护士将在第 $5、6、7、1、2$ 天工作。）然后我们有以下问题表述：

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721004210420.png" alt="image-20210721004210420" style="zoom:50%;" />

这将是一个线性规划问题，而且包含每个 $x_j$ 必须是整数的约束，因此我们实际上有一个线性整数规划问题。 处理这个问题的一种方法是忽略（“放松”）完整约束并获得原始问题的所谓线性规划松弛。 由于线性规划问题的约束较少，因此选项较多，因此最优成本将小于或等于原始问题的最优成本。 在这里，我们可以先忽略得到的结果必须是整数的约束，因此如果线性规划松弛的最优解恰好是整数，那么它也是原问题的最优解。 如果它不是整数，我们可以将每个 $x_j$ 向上舍入，从而获得原始问题的可行但不一定最优的解决方案。 事实证明，对于这个特定问题，无需太多努力即可找到最佳解决方案。然而，这是例外而不是规则：找到一般整数规划问题的最佳解决方案通常很困难； 一些方法将在第 11 章中讨论。

##### Choosing paths in a communication network

考虑一个由 $n$ 个节点组成的通信网络，节点之间通过通信链路连接。 从节点 $i$ 到节点 $j$ 单向传输的链路由有序对 $(i , j )$ 描述。 设 $\mathcal{A}$ 为所有链接的集合。 我们假设每条链路 $(i, j) \in \mathcal{A}$ 每秒最多可承载 $u_{ij}$ 比特。 沿该链路传输的每比特都相当于传输了 $c_{ij}$ 个正电荷。 每个节点 $k$ 以每秒 $b^{k\mathscr{l}}$ 比特的速率生成数据，这些数据必须通过直接链接 $(k,l )$ 或通过一系列的链接传输到节点 $l$ 。 问题是选择所有数据到达其预定目的地的路径，同时最小化总成本。我们允许具有相同来源和相同目的地的数据被拆分并沿着不同的路径传输。

为了将此问题表述为线性规划问题，我们引入了变量 $x_{ij}^{kl}$，表示经过链接 $(i, j)$ 的，起点为 $k$ 和终点 $l$ 的数据，并且记

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721005821978.png" alt="image-20210721005821978" style="zoom:50%;" />

因此，$b_i^{kl}$ 是节点 $i$ 处来自网络外部的源为 $k$ 和目的地为 $l$ 的数据的净流入。 然后我们有以下公式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010148354.png" alt="image-20210721010148354" style="zoom:50%;" />

第一个约束是节点 $i$ 处的流守恒约束，用于具有源 $k$ 和目的地 $l$ 的数据。表达式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010314682.png" alt="image-20210721010314682" style="zoom:50%;" />

分别表示沿某条链路离开节点 $i$ 的具有起点和终点 $k$ 和 $l$ 的数据量。 表达式

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010457968.png" alt="image-20210721010457968" style="zoom:50%;" />

表示通过某个链接进入节点 $i$ 的具有相同来源和目的地的数据量。 最后，$b_i^{kl}$ 是从网络外部进入节点 $i$ 的此类数据的净量。 第二个约束表示通过链路 $(i, j)$ 的总流量不能超过链路容量的要求。

这个问题被称为多商品流问题，对应于每个起点-终点对的流量被视为不同的商品。 当我们考虑一家运输公司希望通过网络将多种商品从原产地运输到目的地时，会出现数学上类似的问题。 这个问题有一个版本，称为最小成本网络流问题，我们不区分不同的商品。 相反，我们在每个节点 $i$ 处获得外部供应或需求量 $b_i$，目标是以最小成本将材料从供应节点运输到需求节点。 网络流问题是第 7 章的主题，它包含一些重要问题作为特殊情况，例如最短路径问题、最大流问题和分配问题。

##### Pattern classification

我们给出了 $m$ 个对象的例子，对于每个对象，比如说第 $i$ 个对象，用一个 $n$ 维向量 $a_i$; 来描述它的特征。 对象属于两个类之一，对于每个示例，我们都被告知它所属的类。

更具体地说，假设每个对象都是一个苹果或一个橙子的图像（这是我们的两个类）。 在这种情况下，我们可以使用一个三维特征向量 $a_i$ 来概括第 $i$ 个图像的内容。  $a_i$ 的三个组成部分（特征）可以是物体的椭圆度、茎的长度和颜色，以某种尺度衡量。 我们有兴趣设计一个分类器，给定一个新对象（除了最初可用的示例之外），它将确定它是一个苹果的图像还是一个橙子的图像。

线性分类器是根据 $n$ 维向量 $x$ 和标量 $x_{n+1}$ 定义的，其操作如下。 给定一个具有特征向量 $a$ 的新对象，分类器将其声明为第一类对象，如果

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721010937777.png" alt="image-20210721010937777" style="zoom:50%;" />

和第二类如果

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721011000413.png" alt="image-20210721011000413" style="zoom:50%;" />

换句话说，线性分类器根据不同特征的线性组合做出决策。 我们的目标是使用可用的例子来设计一个“好的”线性分类器。

有很多方法可以解决这个问题，但一个合理的起点可能是要求分类器必须为每个可用示例给出正确的答案。 设 $S$ 是第一类的例子集。 然后我们正在寻找一些满足约束的 $x$ 和 $x_{n+1}$

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721011121474.png" alt="image-20210721011121474" style="zoom:50%;" />

请注意，第二组约束涉及严格的不等式，并不完全是线性规划中出现的形式。 这个问题可以通过以下方式解决，如果观察到 $x$ 和 $x_{n+1}$ 的某些选择满足所有上述约束，则存在一些其他选择（通过将 $x$ 和 $x_{n+1}$ 乘以适当大的正标量获得）满足

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721011537262.png" alt="image-20210721011537262" style="zoom:50%;" />

我们得出结论，寻找与所有可用示例一致的线性分类器是寻找线性规划问题的可行解的问题

### 1.3 Piecewise linear convex objective functions

上一节中的所有示例都涉及线性目标函数。 然而，有一类重要的优化问题具有非线性目标函数，可以转化为线性规划问题； 接下来将处理这些问题。

我们首先需要一些定义： 

<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20210721012651386.png" alt="image-20210721012651386" style="zoom:50%;" />

请注意，如果 x 和 y 是 lRn 中的向量，并且 A 范围在 [0 , 1] ' 中，那么形式为 AX + (1 - A)y 的点属于连接 x 和 y 的线段。 凸函数的定义是指 f 的值，因为它的参数跟踪这个段。 如果 f 是线性的，则定义的 (a) 部分中的不等式将成立。 因此，不等式意味着当我们将注意力限制在这样的段 上时，函数的图形不高于相应的线性函数的图形； 见图1。  1（一）。
   很容易看出，当且仅当函数 f 是凹函数 f 是凸函数。 请注意，形式为 f(x) = ao + I: 􀁅=l aixi 的函数，其中 ao, .  .  .  , an 是标量，称为仿射函数，既是凸函数又是凹函数。  （事实证明，仿射函数是唯一既是凸函数又是凹函数。）凸函数（以及凹函数）在优化中起着核心作用。
   我们说向量 x 是 f 的局部最小值，如果 f(x) :::;  f(y) 对于 x 附近的所有 y。 我们也说 x 是全局最小值如果 f(x) :::;  f(y) 对于所有 y 。 一个凸函数不能有局部极小而不是全局极小（见图1.1），这个性质对设计高效的优化算法有很大帮助。
   让 Cl , .  .  .  , Cm 是 lRn 中的向量，令 d1 , .  .  .  , dm 为标量，并考虑函数 f : lRn I--t lR 定义为



































































































































































































































































































































































